!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.cube=e()}(this,function(){"use strict";function a(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function st(t){return e(rt(t))}function rt(r){var a=Math.sqrt(r.length);return new Array(a).fill().map(function(t,e){var s=e*a;return r.slice(s,s+a)})}function at(t){return it(e(t))}function it(t){return t.reduce(function(t,e){return t.concat(e)},[])}function e(s){return s[0].map(function(t,e){return s.map(function(t){return t[e]})})}function i(t,s,e){var r=new Array(t).fill(s);return e?r.map(function(t,e){return{index:e,value:s}}):r}function lt(t,e){for(var s=t.depth,r=s,a=t.outer?0:s-1;a<r;r--)e(r)}function l(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,s="";if(t.prime?s="-":t.double&&(s="2"),t.whole)return"".concat(t.face).concat(s);var r="";t.depth&&(r=t.depth);var a=t.face.toUpperCase();return 3<e&&t.outer&&(a=a.toLowerCase()),"".concat(r).concat(a).concat(s)}function u(t,e){return Math.floor(Math.random()*(e-t+1))+t}function ot(t){return t.slice(0).reverse()}function ct(t,e){if(90===e)return at(ot(rt(t)));if(-90===e)return it(ot(st(t)));if(180===e)return ot(t);throw new Error("Invalid rotation degrees, must be 90, -90, or 180")}return function(){function r(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),t=e,Number(t)!==t||t%1!=0||e<2)throw new Error("Cube size must be a whole number greater than 1");this.size=e,this.options=s,this.reset()}var t,e,s;return t=r,(e=[{key:"generateScramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;0===t&&(t=Math.pow(this.size,3));for(var e,s=[],r={u:["l","f","r","b"],l:["u","f","d","b"],f:["l","u","r","d"],r:["u","b","d","f"],b:["u","l","d","r"],d:["f","r","b","l"]},a=0;a<t;a++){var i=2===Boolean(u(0,2)),l=3<this.size&&Boolean(u(0,1)),o=!i&&Boolean(u(0,1)),c=3<this.size?u(0,Math.floor(this.size/2)):0;e=0===a?["u","l","f","r","b","d"][u(0,5)]:r[e][u(0,3)],s.push({depth:c,double:i,face:e,outer:l,prime:o})}return s}},{key:"generateScrambleString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.generateScramble(t).map(l).join(" ")}},{key:"getLastTurn",value:function(){return this.history.slice(-1).pop()}},{key:"isSolved",value:function(){var t=this.state.u[0],e=this.state.l[0],s=this.state.f[0],r=this.state.r[0],a=this.state.b[0],i=this.state.d[0];if(this.options.useObjects){for(var l=1;l<this.size;l++)if(this.state.u[l].value!==t.value||this.state.l[l].value!==e.value||this.state.f[l].value!==s.value||this.state.r[l].value!==r.value||this.state.b[l].value!==a.value||this.state.d[l].value!==i.value)return!1}else for(var o=1;o<this.size;o++)if(this.state.u[o]!==t||this.state.l[o]!==e||this.state.f[o]!==s||this.state.r[o]!==r||this.state.b[o]!==a||this.state.d[o]!==i)return!1;return!0}},{key:"reset",value:function(){this.currentScramble=[],this.history=[];var t=Math.pow(this.size,2),e=!!this.options.useObjects;this.state={u:i(t,0,e),l:i(t,1,e),f:i(t,2,e),r:i(t,3,e),b:i(t,4,e),d:i(t,5,e)}}},{key:"scramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.currentScramble=this.generateScramble(t),this.turn(this.currentScramble,!1)}},{key:"stickers",value:function(t){var e=this.state,s=e.u,r=e.l,a=e.f,i=e.r,l=e.b,o=e.d;[].concat(s,r,a,i,l,o).forEach(t)}},{key:"turn",value:function(t){var tt=this,et=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];(Array.isArray(t)?t:t.split(/[ ,]+/)).forEach(function(t){var e,s,r,a,i,l,o,c,u,n,f,h,d,b,p,v,w,m,y,g,z,k,S,A,M,j,x,C,E,B,L,O,T,W,N="string"==typeof t?(s=(e=t).match(/^[0-9]+/)||1,r=Array.isArray(s)?Number(s[0]):s,a=e.match(/[A-Za-z]/)[0].toLowerCase(),{depth:r,face:a,double:e.endsWith("2"),outer:1===r||null!==e.match(/[a-z]/),prime:e.endsWith("-")||e.endsWith("'"),whole:["x","y","z"].includes(a)}):t,q=N.depth,D=N.double,I=N.face,P=N.outer,U=N.prime,Z=N.whole,F={date:Date.now(),parsedTurn:N};if(et&&tt.history.push(F),Z)return"x"===I?(M=tt,T=(j=N).double,W=j.prime,O=T?(x=M.state.d.slice(),C=ct(M.state.l,180),E=ot(M.state.b),B=ct(M.state.r,180),L=ot(M.state.f),M.state.u.slice()):W?(x=ot(M.state.b),C=ct(M.state.l,90),E=M.state.u.slice(),B=ct(M.state.r,-90),L=ot(M.state.d),M.state.f.slice()):(x=M.state.f.slice(),C=ct(M.state.l,-90),E=M.state.d.slice(),B=ct(M.state.r,90),L=ot(M.state.u),ot(M.state.b)),M.state.u=x,M.state.l=C,M.state.f=E,M.state.r=B,M.state.b=L,M.state.d=O):"y"===I?(p=tt,S=(v=N).double,A=v.prime,k=S?(w=ct(p.state.u,180),m=p.state.r.slice(),y=p.state.b.slice(),g=p.state.l.slice(),z=p.state.f.slice(),ct(p.state.d,180)):A?(w=ct(p.state.u,-90),m=p.state.b.slice(),y=p.state.l.slice(),g=p.state.f.slice(),z=p.state.r.slice(),ct(p.state.d,90)):(w=ct(p.state.u,90),m=p.state.f.slice(),y=p.state.r.slice(),g=p.state.b.slice(),z=p.state.l.slice(),ct(p.state.d,-90)),p.state.u=w,p.state.l=m,p.state.f=y,p.state.r=g,p.state.b=z,p.state.d=k):"z"===I&&(i=tt,d=(l=N).double,b=l.prime,h=d?(o=ot(i.state.d),c=ot(i.state.r),u=ct(i.state.f,180),n=ot(i.state.l),f=ct(i.state.b,180),ot(i.state.u)):b?(o=ct(i.state.r,-90),c=ct(i.state.u,-90),u=ct(i.state.f,-90),n=ct(i.state.d,-90),f=ct(i.state.b,90),ct(i.state.l,-90)):(o=ct(i.state.l,90),c=ct(i.state.d,90),u=ct(i.state.f,90),n=ct(i.state.u,90),f=ct(i.state.b,-90),ct(i.state.r,90)),i.state.u=o,i.state.l=c,i.state.f=u,i.state.r=n,i.state.b=f,i.state.d=h),F;if(P){var G=90;U?G=-90:D&&(G=180),tt.state[I]=ct(tt.state[I],G)}if(q>=tt.size){var H=-90;U?H=90:D&&(H=180);var J={u:"d",l:"r",f:"b",r:"l",b:"f",d:"u"}[I];tt.state[J]=ct(tt.state[J],H)}var K,Q,R,V,X,Y,$,_=(K=tt.state,Q=K.u,R=K.l,V=K.f,X=K.r,Y=K.b,$=K.d,{u:{rows:rt(Q),cols:st(Q)},l:{rows:rt(R),cols:st(R)},f:{rows:rt(V),cols:st(V)},r:{rows:rt(X),cols:st(X)},b:{rows:rt(Y),cols:st(Y)},d:{rows:rt($),cols:st($)}});return"u"===I?function(u,n,t){t.depth;var f=t.double,h=(t.outer,t.prime);lt(t,function(t){var e,s,r,a,i=n.b.rows.slice(t-1).shift(),l=n.r.rows.slice(t-1).shift(),o=n.f.rows.slice(t-1).shift(),c=n.l.rows.slice(t-1).shift();a=f?(e=o,s=c,r=i,l):h?(e=l,s=o,r=c,i):(e=c,s=i,r=l,o),n.b.rows.splice(t-1,1,e),n.r.rows.splice(t-1,1,s),n.f.rows.splice(t-1,1,r),n.l.rows.splice(t-1,1,a),u.state.b=it(n.b.rows),u.state.r=it(n.r.rows),u.state.f=it(n.f.rows),u.state.l=it(n.l.rows)})}(tt,_,N):"l"===I?function(u,n,t){t.depth;var f=t.double,h=(t.outer,t.prime);lt(t,function(t){var e,s,r,a,i=n.u.cols.slice(t-1).shift(),l=n.f.cols.slice(t-1).shift(),o=n.d.cols.slice(t-1).shift(),c=n.b.cols.slice(-t).shift();a=f?(e=o,s=ot(c),r=i,ot(l)):h?(e=l,s=o,r=ot(c),ot(i)):(e=ot(c),s=i,r=l,ot(o)),n.u.cols.splice(t-1,1,e),n.f.cols.splice(t-1,1,s),n.d.cols.splice(t-1,1,r),n.b.cols.splice(-t,1,a),u.state.u=at(n.u.cols),u.state.f=at(n.f.cols),u.state.d=at(n.d.cols),u.state.b=at(n.b.cols)})}(tt,_,N):"f"===I?function(u,n,t){t.depth;var f=t.double,h=(t.outer,t.prime);lt(t,function(t){var e,s,r,a,i=n.u.rows.slice(-t).shift(),l=n.r.cols.slice(t-1).shift(),o=n.d.rows.slice(t-1).shift(),c=n.l.cols.slice(-t).shift();a=f?(e=ot(o),s=ot(c),r=ot(i),ot(l)):h?(e=l,s=ot(o),r=c,ot(i)):(e=ot(c),s=i,r=ot(l),o),n.u.rows.splice(-t,1,e),n.r.cols.splice(t-1,1,s),n.d.rows.splice(t-1,1,r),n.l.cols.splice(-t,1,a),u.state.u=it(n.u.rows),u.state.r=at(n.r.cols),u.state.d=it(n.d.rows),u.state.l=at(n.l.cols)})}(tt,_,N):"r"===I?function(u,n,t){t.depth;var f=t.double,h=(t.outer,t.prime);lt(t,function(t){var e,s,r,a,i=n.u.cols.slice(-t).shift(),l=n.b.cols.slice(t-1).shift(),o=n.d.cols.slice(-t).shift(),c=n.f.cols.slice(-t).shift();a=f?(e=o,s=ot(c),r=i,ot(l)):h?(e=ot(l),s=ot(o),r=c,i):(e=c,s=ot(i),r=ot(l),o),n.u.cols.splice(-t,1,e),n.b.cols.splice(t-1,1,s),n.d.cols.splice(-t,1,r),n.f.cols.splice(-t,1,a),u.state.u=at(n.u.cols),u.state.b=at(n.b.cols),u.state.d=at(n.d.cols),u.state.f=at(n.f.cols)})}(tt,_,N):"b"===I?function(u,n,t){t.depth;var f=t.double,h=(t.outer,t.prime);lt(t,function(t){var e,s,r,a,i=n.u.rows.slice(t-1).shift(),l=n.l.cols.slice(t-1).shift(),o=n.d.rows.slice(-t).shift(),c=n.r.cols.slice(-t).shift();a=f?(e=ot(o),s=ot(c),r=ot(i),ot(l)):h?(e=ot(l),s=o,r=ot(c),i):(e=c,s=ot(i),r=l,ot(o)),n.u.rows.splice(t-1,1,e),n.l.cols.splice(t-1,1,s),n.d.rows.splice(-t,1,r),n.r.cols.splice(-t,1,a),u.state.u=it(n.u.rows),u.state.l=at(n.l.cols),u.state.d=it(n.d.rows),u.state.r=at(n.r.cols)})}(tt,_,N):"d"===I&&function(u,n,t){t.depth;var f=t.double,h=(t.outer,t.prime);lt(t,function(t){var e,s,r,a,i=n.f.rows.slice(-t).shift(),l=n.r.rows.slice(-t).shift(),o=n.b.rows.slice(-t).shift(),c=n.l.rows.slice(-t).shift();a=f?(e=o,s=c,r=i,l):h?(e=l,s=o,r=c,i):(e=c,s=i,r=l,o),n.f.rows.splice(-t,1,e),n.r.rows.splice(-t,1,s),n.b.rows.splice(-t,1,r),n.l.rows.splice(-t,1,a),u.state.f=it(n.f.rows),u.state.r=it(n.r.rows),u.state.b=it(n.b.rows),u.state.l=it(n.l.rows)})}(tt,_,N),F})}}])&&a(t.prototype,e),s&&a(t,s),r}()});

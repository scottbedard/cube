!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.cube=r()}(this,function(){"use strict";function a(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ft(n){var t=function(t,r){var e=n.match(t);return Array.isArray(e)&&e[1]||r},r=n.includes("w"),e=parseInt(t(/^([0-9]+)/,1),10);r&&(e=Math.max(2,e));var a=t(/([ULFRBDXYZ])/i,"").toUpperCase(),i=1;return n.endsWith("-")||n.endsWith("'")?i=-1:n.endsWith("2")&&(i=2),{depth:e,target:a,wide:r,rotation:i}}function i(t){var r=t.depth,e=t.target,n=t.wide,a=t.rotation,i="";1<r&&!n?i=2:2<r&&(i=r);var o=n?"w":"",c="";return-1===a?c="-":2===a&&(c=2),"".concat(i).concat(e).concat(o).concat(c)}function vt(t){return r(lt(t))}function lt(n){var a=Math.sqrt(n.length);return new Array(a).fill().map(function(t,r){var e=r*a;return Rt(n,e,e+a)})}function ht(t,r){return Rt(t,r).shift()}function Dt(t){return Ut(r(t))}function Ut(t){return t.reduce(function(t,r){return t.concat(r)},[])}function r(e){return e[0].map(function(t,r){return e.map(function(t){return t[r]})})}function o(t,e,r){var n=new Array(t).fill(e);return r?n.map(function(t,r){return{originalIndex:r,value:e}}):n}function Bt(t,r){for(var e=t.depth,n=e,a=t.wide?0:e-1;a<n;n--)r(n,-n,n-1)}function u(t,r){return Math.floor(Math.random()*(r-t+1))+t}function Ft(t){return Rt(t).reverse()}function Lt(t,r){return 1===r?Dt(Ft(lt(t))):-1===r?Ut(Ft(vt(t))):2===r?Ft(t):void 0}function Rt(t,r,e){return t.slice(r,e)}function dt(t,r,e,n){return t.splice(r,e,n)}return function(){function n(){var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,n),t=r,Number(t)!==t||t%1!=0||r<2)throw new Error("Cube size must be a whole number greater than 1");this.size=r,this.options=e,this.reset()}var t,r,e;return t=n,(r=[{key:"generateScramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;0===t&&(t=Math.pow(this.size,3));for(var r,e={U:["L","F","R","B"],L:["U","F","D","B"],F:["L","U","R","D"],R:["U","B","D","F"],B:["U","L","D","R"],D:["F","R","B","L"]},n=[],a=0;a<t;a++){var i=3<this.size?u(0,Math.floor(this.size/2)):1,o=[-1,1,2][u(0,2)],c=3<this.size&&!!u(0,1);r=a<1?["U","L","F","R","B","D"][u(0,5)]:e[r][u(0,3)],n.push({depth:i,wide:c,target:r,rotation:o})}return n}},{key:"generateScrambleString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.generateScramble(t).map(i).join(" ")}},{key:"isSolved",value:function(){var t=this.state,r=t.U.length,e=t.U[0],n=t.L[0],a=t.F[0],i=t.R[0],o=t.B[0],c=t.D[0];if(this.options.useObjects){for(var u=1;u<r;u++)if(t.U[u].value!==e.value||t.L[u].value!==n.value||t.F[u].value!==a.value||t.R[u].value!==i.value||t.B[u].value!==o.value||t.D[u].value!==c.value)return!1}else for(var s=1;s<r;s++)if(t.U[s]!==e||t.L[s]!==n||t.F[s]!==a||t.R[s]!==i||t.B[s]!==o||t.D[s]!==c)return!1;return!0}},{key:"parseTurn",value:function(t){return ft(t)}},{key:"reset",value:function(){var t=Math.pow(this.size,2),r=!!this.options.useObjects;this.state={U:o(t,0,r),L:o(t,1,r),F:o(t,2,r),R:o(t,3,r),B:o(t,4,r),D:o(t,5,r)}}},{key:"scramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.currentScramble=this.generateScramble(t),this.turn(this.currentScramble,!1)}},{key:"stickers",value:function(t){var r=this.state,e=r.U,n=r.L,a=r.F,i=r.R,o=r.B,c=r.D;[].concat(e,n,a,i,o,c).forEach(t)}},{key:"turn",value:function(t){var ut=this,st=this.state;(Array.isArray(t)?t:t.split(/[ ,]+/)).forEach(function(t){var f,v,l,h,D,U,B,F,L,R,d,p,m,y,g,b,w,k,r,e,n,a,i,o,c,u,s,z,S,M,A,j,x,E,C,O,T,W,I,X,Y,Z,q,N,P,G,H,J,K,Q,V,$,_="string"==typeof t?ft(t):t,tt=_.depth,rt=_.target,et=_.wide,nt=_.rotation,at={date:Date.now(),parsedTurn:_};if("X"===rt)N=_,V=ut.state,$=-1===N.rotation,Q=2===N.rotation?(P=Rt(V.D),G=Lt(V.L,2),H=Ft(V.B),J=Lt(V.R,2),K=Ft(V.F),Rt(V.U)):$?(P=Ft(V.B),G=Lt(V.L,1),H=Rt(V.U),J=Lt(V.R,-1),K=Ft(V.D),Rt(V.F)):(P=Rt(V.F),G=Lt(V.L,-1),H=Rt(V.D),J=Lt(V.R,1),K=Ft(V.U),Ft(V.B)),V.U=P,V.L=G,V.F=H,V.R=J,V.B=K,V.D=Q;else if("Y"===rt)C=_,Z=ut.state,q=-1===C.rotation,Y=2===C.rotation?(O=Lt(Z.U,2),T=Rt(Z.R),W=Rt(Z.B),I=Rt(Z.L),X=Rt(Z.F),Lt(Z.D,2)):q?(O=Lt(Z.U,-1),T=Rt(Z.B),W=Rt(Z.L),I=Rt(Z.F),X=Rt(Z.R),Lt(Z.D,1)):(O=Lt(Z.U,1),T=Rt(Z.F),W=Rt(Z.R),I=Rt(Z.B),X=Rt(Z.L),Lt(Z.D,-1)),Z.U=O,Z.L=T,Z.F=W,Z.R=I,Z.B=X,Z.D=Y;else if("Z"===rt)u=_,x=ut.state,E=-1===u.rotation,j=2===u.rotation?(s=Ft(x.D),z=Ft(x.R),S=Lt(x.F,2),M=Ft(x.L),A=Lt(x.B,2),Ft(x.U)):E?(s=Lt(x.R,-1),z=Lt(x.U,-1),S=Lt(x.F,-1),M=Lt(x.D,-1),A=Lt(x.B,1),Lt(x.L,-1)):(s=Lt(x.L,1),z=Lt(x.D,1),S=Lt(x.F,1),M=Lt(x.U,1),A=Lt(x.B,-1),Lt(x.R,1)),x.U=s,x.L=z,x.F=S,x.R=M,x.B=A,x.D=j;else{if((1===tt||et)&&(st[rt]=Lt(st[rt],nt)),tt>=ut.size){var it=2;1!==nt&&-1!==nt||(it=-1*nt);var ot={U:"D",L:"R",F:"B",R:"L",B:"F",D:"D"}[rt];st[ot]=Lt(st[ot],it)}var ct=(r=ut.state,e=r.U,n=r.L,a=r.F,i=r.R,o=r.B,c=r.D,{U:{r:lt(e),c:vt(e)},L:{r:lt(n),c:vt(n)},F:{r:lt(a),c:vt(a)},R:{r:lt(i),c:vt(i)},B:{r:lt(o),c:vt(o)},D:{r:lt(c),c:vt(c)}});"U"===rt?(b=ct,w=_,k=ut.state,Bt(w,function(t,r,e){var n,a,i,o,c=ht(b.B.r,e),u=ht(b.R.r,e),s=ht(b.F.r,e),f=ht(b.L.r,e);o=2===w.rotation?(n=s,a=f,i=c,u):-1===w.rotation?(n=u,a=s,i=f,c):(n=f,a=c,i=u,s),dt(b.B.r,e,1,n),dt(b.R.r,e,1,a),dt(b.F.r,e,1,i),dt(b.L.r,e,1,o),k.B=Ut(b.B.r),k.R=Ut(b.R.r),k.F=Ut(b.F.r),k.L=Ut(b.L.r)})):"L"===rt?(m=ct,y=_,g=ut.state,Bt(y,function(t,r,e){var n,a,i,o,c=ht(m.U.c,e),u=ht(m.F.c,e),s=ht(m.D.c,e),f=ht(m.B.c,r);o=2===y.rotation?(n=s,a=Ft(f),i=c,Ft(u)):-1===y.rotation?(n=u,a=s,i=Ft(f),Ft(c)):(n=Ft(f),a=c,i=u,Ft(s)),dt(m.U.c,e,1,n),dt(m.F.c,e,1,a),dt(m.D.c,e,1,i),dt(m.B.c,r,1,o),g.U=Dt(m.U.c),g.F=Dt(m.F.c),g.D=Dt(m.D.c),g.B=Dt(m.B.c)})):"F"===rt?(R=ct,d=_,p=ut.state,Bt(d,function(t,r,e){var n,a,i,o,c=ht(R.U.r,r),u=ht(R.R.c,e),s=ht(R.D.r,e),f=ht(R.L.c,r);o=2===d.rotation?(n=Ft(s),a=Ft(f),i=Ft(c),Ft(u)):-1===d.rotation?(n=u,a=Ft(s),i=f,Ft(c)):(n=Ft(f),a=c,i=Ft(u),s),dt(R.U.r,r,1,n),dt(R.R.c,e,1,a),dt(R.D.r,e,1,i),dt(R.L.c,r,1,o),p.U=Ut(R.U.r),p.R=Dt(R.R.c),p.D=Ut(R.D.r),p.L=Dt(R.L.c)})):"R"===rt?(B=ct,F=_,L=ut.state,Bt(F,function(t,r,e){var n,a,i,o,c=ht(B.U.c,r),u=ht(B.B.c,e),s=ht(B.D.c,r),f=ht(B.F.c,r);o=2===F.rotation?(n=s,a=Ft(f),i=c,Ft(u)):-1===F.rotation?(n=Ft(u),a=Ft(s),i=f,c):(n=f,a=Ft(c),i=Ft(u),s),dt(B.U.c,r,1,n),dt(B.B.c,e,1,a),dt(B.D.c,r,1,i),dt(B.F.c,r,1,o),L.U=Dt(B.U.c),L.B=Dt(B.B.c),L.D=Dt(B.D.c),L.F=Dt(B.F.c)})):"B"===rt?(h=ct,D=_,U=ut.state,Bt(D,function(t,r,e){var n,a,i,o,c=ht(h.U.r,e),u=ht(h.L.c,e),s=ht(h.D.r,r),f=ht(h.R.c,r);o=2===D.rotation?(n=Ft(s),a=Ft(f),i=Ft(c),Ft(u)):-1===D.rotation?(n=Ft(u),a=s,i=Ft(f),c):(n=f,a=Ft(c),i=u,Ft(s)),dt(h.U.r,t-1,1,n),dt(h.L.c,t-1,1,a),dt(h.D.r,r,1,i),dt(h.R.c,r,1,o),U.U=Ut(h.U.r),U.L=Dt(h.L.c),U.D=Ut(h.D.r),U.R=Dt(h.R.c)})):"D"===rt&&(f=ct,v=_,l=ut.state,Bt(v,function(t,r){var e,n,a,i,o=ht(f.F.r,r),c=ht(f.R.r,r),u=ht(f.B.r,r),s=ht(f.L.r,r);i=2===v.rotation?(e=u,n=s,a=o,c):-1===v.rotation?(e=c,n=u,a=s,o):(e=s,n=o,a=c,u),dt(f.F.r,r,1,e),dt(f.R.r,r,1,n),dt(f.B.r,r,1,a),dt(f.L.r,r,1,i),l.F=Ut(f.F.r),l.R=Ut(f.R.r),l.B=Ut(f.B.r),l.L=Ut(f.L.r)}))}return at})}}])&&a(t.prototype,r),e&&a(t,e),n}()});

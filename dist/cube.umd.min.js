!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.cube=e()}(this,function(){"use strict";function r(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function ut(a){var t=function(t,e){var s=a.match(t);return Array.isArray(s)&&s[1]||e},e=a.includes("w"),s=parseInt(t(/^([0-9]+)/,1),10);e&&(s=Math.max(2,s));var r=t(/([ULFRBDXYZ])/i,"").toUpperCase(),o=1;return a.endsWith("-")||a.endsWith("'")?o=-1:a.endsWith("2")&&(o=2),{depth:s,target:r,wide:e,rotation:o}}function o(t){var e=t.depth,s=t.target,a=t.wide,r=t.rotation,o="";1<e&&!a?o=2:2<e&&(o=e);var n=a?"w":"",i="";return-1===r?i="-":2===r&&(i=2),"".concat(o).concat(s).concat(n).concat(i)}function lt(t){return e(ft(t))}function ft(a){var r=Math.sqrt(a.length);return new Array(r).fill().map(function(t,e){var s=e*r;return Ft(a,s,s+r)})}function ht(t,e){return Ft(t,e).shift()}function vt(t){return wt(e(t))}function wt(t){return t.reduce(function(t,e){return t.concat(e)},[])}function e(s){return s[0].map(function(t,e){return s.map(function(t){return t[e]})})}function n(t,s,e){var a=new Array(t).fill(s);return e?a.map(function(t,e){return{originalIndex:e,value:s}}):a}function Dt(t,e){for(var s=t.depth,a=s,r=t.wide?0:s-1;r<a;a--)e(a,-a,a-1)}function c(t,e){return Math.floor(Math.random()*(e-t+1))+t}function Ut(t){return Ft(t).reverse()}function Bt(t,e){return 1===e?vt(Ut(ft(t))):-1===e?wt(Ut(lt(t))):2===e?Ut(t):void 0}function Ft(t,e,s){return t.slice(e,s)}function Lt(t,e,s,a){return t.splice(e,s,a)}return function(){function a(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=e,Number(t)!==t||t%1!=0||e<2)throw new Error("Cube size must be a whole number greater than 1");this.size=e,this.options=s,this.reset()}var t,e,s;return t=a,(e=[{key:"generateScramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;0===t&&(t=Math.pow(this.size,3));for(var e,s={U:["L","F","R","B"],L:["U","F","D","B"],F:["L","U","R","D"],R:["U","B","D","F"],B:["U","L","D","R"],D:["F","R","B","L"]},a=[],r=0;r<t;r++){var o=3<this.size?c(0,Math.floor(this.size/2)):1,n=[-1,1,2][c(0,2)],i=3<this.size&&!!c(0,1);e=r<1?["U","L","F","R","B","D"][c(0,5)]:s[e][c(0,3)],a.push({depth:o,wide:i,target:e,rotation:n})}return a}},{key:"generateScrambleString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.generateScramble(t).map(o).join(" ")}},{key:"isSolved",value:function(){var t=this.state.U.length,e=this.state.U[0],s=this.state.L[0],a=this.state.F[0],r=this.state.R[0],o=this.state.B[0],n=this.state.D[0];if(this.options.useObjects){for(var i=1;i<t;i++)if(this.state.U[i].value!==e.value||this.state.L[i].value!==s.value||this.state.F[i].value!==a.value||this.state.R[i].value!==r.value||this.state.B[i].value!==o.value||this.state.D[i].value!==n.value)return!1}else for(var c=1;c<t;c++)if(this.state.U[c]!==e||this.state.L[c]!==s||this.state.F[c]!==a||this.state.R[c]!==r||this.state.B[c]!==o||this.state.D[c]!==n)return!1;return!0}},{key:"parseTurn",value:function(t){return ut(t)}},{key:"reset",value:function(){var t=Math.pow(this.size,2),e=!!this.options.useObjects;this.state={U:n(t,0,e),L:n(t,1,e),F:n(t,2,e),R:n(t,3,e),B:n(t,4,e),D:n(t,5,e)}}},{key:"scramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.currentScramble=this.generateScramble(t),this.turn(this.currentScramble,!1)}},{key:"stickers",value:function(t){var e=this.state,s=e.U,a=e.L,r=e.F,o=e.R,n=e.B,i=e.D;[].concat(s,a,r,o,n,i).forEach(t)}},{key:"turn",value:function(t){var ct=this;(Array.isArray(t)?t:t.split(/[ ,]+/)).forEach(function(t){var l,f,h,v,w,D,U,B,F,L,R,d,p,m,y,g,b,k,e,s,a,r,o,n,i,c,u,z,S,M,A,j,x,E,C,O,T,W,I,X,Y,Z,q,N,P,G,H,J,K,Q,V,$,_="string"==typeof t?ut(t):t,tt=_.depth,et=_.target,st=_.wide,at=_.rotation,rt={date:Date.now(),parsedTurn:_};if("X"===et)N=ct,$=-1===(P=_).rotation,V=2===P.rotation?(G=Ft(N.state.D),H=Bt(N.state.L,2),J=Ut(N.state.B),K=Bt(N.state.R,2),Q=Ut(N.state.F),Ft(N.state.U)):$?(G=Ut(N.state.B),H=Bt(N.state.L,1),J=Ft(N.state.U),K=Bt(N.state.R,-1),Q=Ut(N.state.D),Ft(N.state.F)):(G=Ft(N.state.F),H=Bt(N.state.L,-1),J=Ft(N.state.D),K=Bt(N.state.R,1),Q=Ut(N.state.U),Ut(N.state.B)),N.state.U=G,N.state.L=H,N.state.F=J,N.state.R=K,N.state.B=Q,N.state.D=V;else if("Y"===et)C=ct,q=-1===(O=_).rotation,Z=2===O.rotation?(T=Bt(C.state.U,2),W=Ft(C.state.R),I=Ft(C.state.B),X=Ft(C.state.L),Y=Ft(C.state.F),Bt(C.state.D,2)):q?(T=Bt(C.state.U,-1),W=Ft(C.state.B),I=Ft(C.state.L),X=Ft(C.state.F),Y=Ft(C.state.R),Bt(C.state.D,1)):(T=Bt(C.state.U,1),W=Ft(C.state.F),I=Ft(C.state.R),X=Ft(C.state.B),Y=Ft(C.state.L),Bt(C.state.D,-1)),C.state.U=T,C.state.L=W,C.state.F=I,C.state.R=X,C.state.B=Y,C.state.D=Z;else if("Z"===et)c=ct,E=-1===(u=_).rotation,x=2===u.rotation?(z=Ut(c.state.D),S=Ut(c.state.R),M=Bt(c.state.F,2),A=Ut(c.state.L),j=Bt(c.state.B,2),Ut(c.state.U)):E?(z=Bt(c.state.R,-1),S=Bt(c.state.U,-1),M=Bt(c.state.F,-1),A=Bt(c.state.D,-1),j=Bt(c.state.B,1),Bt(c.state.L,-1)):(z=Bt(c.state.L,1),S=Bt(c.state.D,1),M=Bt(c.state.F,1),A=Bt(c.state.U,1),j=Bt(c.state.B,-1),Bt(c.state.R,1)),c.state.U=z,c.state.L=S,c.state.F=M,c.state.R=A,c.state.B=j,c.state.D=x;else{if((1===tt||st)&&(ct.state[et]=Bt(ct.state[et],at)),tt>=ct.size){var ot=2;1!==at&&-1!==at||(ot=-1*at);var nt={U:"D",L:"R",F:"B",R:"L",B:"F",D:"D"}[et];ct.state[nt]=Bt(ct.state[nt],ot)}var it=(e=ct.state,s=e.U,a=e.L,r=e.F,o=e.R,n=e.B,i=e.D,{U:{rows:ft(s),cols:lt(s)},L:{rows:ft(a),cols:lt(a)},F:{rows:ft(r),cols:lt(r)},R:{rows:ft(o),cols:lt(o)},B:{rows:ft(n),cols:lt(n)},D:{rows:ft(i),cols:lt(i)}});"U"===et?(g=ct,b=it,Dt(k=_,function(t,e,s){var a,r,o,n,i=ht(b.B.rows,s),c=ht(b.R.rows,s),u=ht(b.F.rows,s),l=ht(b.L.rows,s);n=2===k.rotation?(a=u,r=l,o=i,c):-1===k.rotation?(a=c,r=u,o=l,i):(a=l,r=i,o=c,u),Lt(b.B.rows,s,1,a),Lt(b.R.rows,s,1,r),Lt(b.F.rows,s,1,o),Lt(b.L.rows,s,1,n),g.state.B=wt(b.B.rows),g.state.R=wt(b.R.rows),g.state.F=wt(b.F.rows),g.state.L=wt(b.L.rows)})):"L"===et?(p=ct,m=it,Dt(y=_,function(t,e,s){var a,r,o,n,i=ht(m.U.cols,s),c=ht(m.F.cols,s),u=ht(m.D.cols,s),l=ht(m.B.cols,e);n=2===y.rotation?(a=u,r=Ut(l),o=i,Ut(c)):-1===y.rotation?(a=c,r=u,o=Ut(l),Ut(i)):(a=Ut(l),r=i,o=c,Ut(u)),Lt(m.U.cols,s,1,a),Lt(m.F.cols,s,1,r),Lt(m.D.cols,s,1,o),Lt(m.B.cols,e,1,n),p.state.U=vt(m.U.cols),p.state.F=vt(m.F.cols),p.state.D=vt(m.D.cols),p.state.B=vt(m.B.cols)})):"F"===et?(L=ct,R=it,Dt(d=_,function(t,e,s){var a,r,o,n,i=ht(R.U.rows,e),c=ht(R.R.cols,s),u=ht(R.D.rows,s),l=ht(R.L.cols,e);n=2===d.rotation?(a=Ut(u),r=Ut(l),o=Ut(i),Ut(c)):-1===d.rotation?(a=c,r=Ut(u),o=l,Ut(i)):(a=Ut(l),r=i,o=Ut(c),u),Lt(R.U.rows,e,1,a),Lt(R.R.cols,s,1,r),Lt(R.D.rows,s,1,o),Lt(R.L.cols,e,1,n),L.state.U=wt(R.U.rows),L.state.R=vt(R.R.cols),L.state.D=wt(R.D.rows),L.state.L=vt(R.L.cols)})):"R"===et?(U=ct,B=it,Dt(F=_,function(t,e,s){var a,r,o,n,i=ht(B.U.cols,e),c=ht(B.B.cols,s),u=ht(B.D.cols,e),l=ht(B.F.cols,e);n=2===F.rotation?(a=u,r=Ut(l),o=i,Ut(c)):-1===F.rotation?(a=Ut(c),r=Ut(u),o=l,i):(a=l,r=Ut(i),o=Ut(c),u),Lt(B.U.cols,e,1,a),Lt(B.B.cols,s,1,r),Lt(B.D.cols,e,1,o),Lt(B.F.cols,e,1,n),U.state.U=vt(B.U.cols),U.state.B=vt(B.B.cols),U.state.D=vt(B.D.cols),U.state.F=vt(B.F.cols)})):"B"===et?(v=ct,w=it,Dt(D=_,function(t,e,s){var a,r,o,n,i=ht(w.U.rows,s),c=ht(w.L.cols,s),u=ht(w.D.rows,e),l=ht(w.R.cols,e);n=2===D.rotation?(a=Ut(u),r=Ut(l),o=Ut(i),Ut(c)):-1===D.rotation?(a=Ut(c),r=u,o=Ut(l),i):(a=l,r=Ut(i),o=c,Ut(u)),Lt(w.U.rows,t-1,1,a),Lt(w.L.cols,t-1,1,r),Lt(w.D.rows,e,1,o),Lt(w.R.cols,e,1,n),v.state.U=wt(w.U.rows),v.state.L=vt(w.L.cols),v.state.D=wt(w.D.rows),v.state.R=vt(w.R.cols)})):"D"===et&&(l=ct,f=it,Dt(h=_,function(t,e){var s,a,r,o,n=ht(f.F.rows,e),i=ht(f.R.rows,e),c=ht(f.B.rows,e),u=ht(f.L.rows,e);o=2===h.rotation?(s=c,a=u,r=n,i):-1===h.rotation?(s=i,a=c,r=u,n):(s=u,a=n,r=i,c),Lt(f.F.rows,e,1,s),Lt(f.R.rows,e,1,a),Lt(f.B.rows,e,1,r),Lt(f.L.rows,e,1,o),l.state.F=wt(f.F.rows),l.state.R=wt(f.R.rows),l.state.B=wt(f.B.rows),l.state.L=wt(f.L.rows)}))}return rt})}}])&&r(t.prototype,e),s&&r(t,s),a}()});

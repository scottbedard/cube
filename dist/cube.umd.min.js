!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.cube=e()}(this,function(){"use strict";function a(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function Y(t){return e($(t))}function $(s){var a=Math.sqrt(s.length);return new Array(a).fill().map(function(t,e){var r=e*a;return ut(s,r,r+a)})}function _(t,e){return ut(t,e).shift()}function tt(t){return et(e(t))}function et(t){return t.reduce(function(t,e){return t.concat(e)},[])}function e(r){return r[0].map(function(t,e){return r.map(function(t){return t[e]})})}function o(t,r,e){var s=new Array(t).fill(r);return e?s.map(function(t,e){return{originalIndex:e,value:r}}):s}function rt(t,e){for(var r=t.depth,s=r,a=t.outer?0:r-1;a<s;s--)e(s,-s,s-1)}function st(t){var e=t.match(/^[0-9]+/)||1,r=Array.isArray(e)?Number(e[0]):e,s=t.match(/[A-Za-z]/)[0].toLowerCase();return{depth:r,face:s,double:t.endsWith("2"),outer:1===r||null!==t.match(/[a-z]/),prime:t.endsWith("-")||t.endsWith("'"),whole:["x","y","z"].includes(s)}}function u(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3,r="";if(t.prime?r="-":t.double&&(r="2"),t.whole)return"".concat(t.face).concat(r);var s="";1<t.depth&&(s=t.depth);var a=t.face.toUpperCase();return 3<e&&t.outer&&(a=a.toLowerCase()),"".concat(s).concat(a).concat(r)}function i(t,e){return Math.floor(Math.random()*(e-t+1))+t}function at(t){return ut(t).reverse()}function ot(t,e){if(90===e)return tt(at($(t)));if(-90===e)return et(at(Y(t)));if(180===e)return at(t);throw new Error("Invalid rotation degrees, must be 90, -90, or 180")}function ut(t,e,r){return t.slice(e,r)}function nt(t,e,r,s){return t.splice(e,r,s)}return function(){function s(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),t=e,Number(t)!==t||t%1!=0||e<2)throw new Error("Cube size must be a whole number greater than 1");this.size=e,this.options=r,this.reset()}var t,e,r;return t=s,(e=[{key:"generateScramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;0===t&&(t=Math.pow(this.size,3));for(var e,r=[],s={u:["l","f","r","b"],l:["u","f","d","b"],f:["l","u","r","d"],r:["u","b","d","f"],b:["u","l","d","r"],d:["f","r","b","l"]},a=0;a<t;a++){var o=2===Boolean(i(0,2)),u=3<this.size&&Boolean(i(0,1)),n=!o&&Boolean(i(0,1)),l=3<this.size?i(0,Math.floor(this.size/2)):0;e=0===a?["u","l","f","r","b","d"][i(0,5)]:s[e][i(0,3)],r.push({depth:l,double:o,face:e,outer:u,prime:n})}return r}},{key:"generateScrambleString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.generateScramble(t).map(u).join(" ")}},{key:"isSolved",value:function(){var t=this.state.u.length,e=this.state.u[0],r=this.state.l[0],s=this.state.f[0],a=this.state.r[0],o=this.state.b[0],u=this.state.d[0];if(this.options.useObjects){for(var n=1;n<t;n++)if(this.state.u[n].value!==e.value||this.state.l[n].value!==r.value||this.state.f[n].value!==s.value||this.state.r[n].value!==a.value||this.state.b[n].value!==o.value||this.state.d[n].value!==u.value)return!1}else for(var l=1;l<t;l++)if(this.state.u[l]!==e||this.state.l[l]!==r||this.state.f[l]!==s||this.state.r[l]!==a||this.state.b[l]!==o||this.state.d[l]!==u)return!1;return!0}},{key:"parseTurn",value:function(t){return st(t)}},{key:"reset",value:function(){var t=Math.pow(this.size,2),e=!!this.options.useObjects;this.state={u:o(t,0,e),l:o(t,1,e),f:o(t,2,e),r:o(t,3,e),b:o(t,4,e),d:o(t,5,e)}}},{key:"scramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.currentScramble=this.generateScramble(t),this.turn(this.currentScramble,!1)}},{key:"stickers",value:function(t){var e=this.state,r=e.u,s=e.l,a=e.f,o=e.r,u=e.b,n=e.d;[].concat(r,s,a,o,u,n).forEach(t)}},{key:"turn",value:function(t){var X=this;(Array.isArray(t)?t:t.split(/[ ,]+/)).forEach(function(t){var e,r,s,a,o,u,n,l,i,c,f,d,h,b,v,w,p,m,y,g,z,k,S,A,M,j,x,C,E,B,O="string"==typeof t?st(t):t,T=O.depth,W=O.double,I=O.face,L=O.outer,N=O.prime,q=O.whole,D={date:Date.now(),parsedTurn:O};if(q)return"x"===I?(z=X,E=(k=O).double,B=k.prime,C=E?(S=ut(z.state.d),A=ot(z.state.l,180),M=at(z.state.b),j=ot(z.state.r,180),x=at(z.state.f),ut(z.state.u)):B?(S=at(z.state.b),A=ot(z.state.l,90),M=ut(z.state.u),j=ot(z.state.r,-90),x=at(z.state.d),ut(z.state.f)):(S=ut(z.state.f),A=ot(z.state.l,-90),M=ut(z.state.d),j=ot(z.state.r,90),x=at(z.state.u),at(z.state.b)),z.state.u=S,z.state.l=A,z.state.f=M,z.state.r=j,z.state.b=x,z.state.d=C):"y"===I?(f=X,y=(d=O).double,g=d.prime,m=y?(h=ot(f.state.u,180),b=ut(f.state.r),v=ut(f.state.b),w=ut(f.state.l),p=ut(f.state.f),ot(f.state.d,180)):g?(h=ot(f.state.u,-90),b=ut(f.state.b),v=ut(f.state.l),w=ut(f.state.f),p=ut(f.state.r),ot(f.state.d,90)):(h=ot(f.state.u,90),b=ut(f.state.f),v=ut(f.state.r),w=ut(f.state.b),p=ut(f.state.l),ot(f.state.d,-90)),f.state.u=h,f.state.l=b,f.state.f=v,f.state.r=w,f.state.b=p,f.state.d=m):"z"===I&&(e=X,i=(r=O).double,c=r.prime,l=i?(s=at(e.state.d),a=at(e.state.r),o=ot(e.state.f,180),u=at(e.state.l),n=ot(e.state.b,180),at(e.state.u)):c?(s=ot(e.state.r,-90),a=ot(e.state.u,-90),o=ot(e.state.f,-90),u=ot(e.state.d,-90),n=ot(e.state.b,90),ot(e.state.l,-90)):(s=ot(e.state.l,90),a=ot(e.state.d,90),o=ot(e.state.f,90),u=ot(e.state.u,90),n=ot(e.state.b,-90),ot(e.state.r,90)),e.state.u=s,e.state.l=a,e.state.f=o,e.state.r=u,e.state.b=n,e.state.d=l),D;if(L){var P=90;N?P=-90:W&&(P=180),X.state[I]=ot(X.state[I],P)}if(T>=X.size){var U=-90;N?U=90:W&&(U=180);var Z={u:"d",l:"r",f:"b",r:"l",b:"f",d:"u"}[I];X.state[Z]=ot(X.state[Z],U)}var F,G,H,J,K,Q,R,V=(F=X.state,G=F.u,H=F.l,J=F.f,K=F.r,Q=F.b,R=F.d,{u:{rows:$(G),cols:Y(G)},l:{rows:$(H),cols:Y(H)},f:{rows:$(J),cols:Y(J)},r:{rows:$(K),cols:Y(K)},b:{rows:$(Q),cols:Y(Q)},d:{rows:$(R),cols:Y(R)}});return"u"===I?function(f,d,t){t.depth;var h=t.double,b=(t.outer,t.prime);rt(t,function(t,e,r){var s,a,o,u,n=_(d.b.rows,r),l=_(d.r.rows,r),i=_(d.f.rows,r),c=_(d.l.rows,r);u=h?(s=i,a=c,o=n,l):b?(s=l,a=i,o=c,n):(s=c,a=n,o=l,i),nt(d.b.rows,r,1,s),nt(d.r.rows,r,1,a),nt(d.f.rows,r,1,o),nt(d.l.rows,r,1,u),f.state.b=et(d.b.rows),f.state.r=et(d.r.rows),f.state.f=et(d.f.rows),f.state.l=et(d.l.rows)})}(X,V,O):"l"===I?function(f,d,t){t.depth;var h=t.double,b=(t.outer,t.prime);rt(t,function(t,e,r){var s,a,o,u,n=_(d.u.cols,r),l=_(d.f.cols,r),i=_(d.d.cols,r),c=_(d.b.cols,e);u=h?(s=i,a=at(c),o=n,at(l)):b?(s=l,a=i,o=at(c),at(n)):(s=at(c),a=n,o=l,at(i)),nt(d.u.cols,r,1,s),nt(d.f.cols,r,1,a),nt(d.d.cols,r,1,o),nt(d.b.cols,e,1,u),f.state.u=tt(d.u.cols),f.state.f=tt(d.f.cols),f.state.d=tt(d.d.cols),f.state.b=tt(d.b.cols)})}(X,V,O):"f"===I?function(f,d,t){t.depth;var h=t.double,b=(t.outer,t.prime);rt(t,function(t,e,r){var s,a,o,u,n=_(d.u.rows,e),l=_(d.r.cols,r),i=_(d.d.rows,r),c=_(d.l.cols,e);u=h?(s=at(i),a=at(c),o=at(n),at(l)):b?(s=l,a=at(i),o=c,at(n)):(s=at(c),a=n,o=at(l),i),nt(d.u.rows,e,1,s),nt(d.r.cols,r,1,a),nt(d.d.rows,r,1,o),nt(d.l.cols,e,1,u),f.state.u=et(d.u.rows),f.state.r=tt(d.r.cols),f.state.d=et(d.d.rows),f.state.l=tt(d.l.cols)})}(X,V,O):"r"===I?function(f,d,t){t.depth;var h=t.double,b=(t.outer,t.prime);rt(t,function(t,e,r){var s,a,o,u,n=_(d.u.cols,e),l=_(d.b.cols,r),i=_(d.d.cols,e),c=_(d.f.cols,e);u=h?(s=i,a=at(c),o=n,at(l)):b?(s=at(l),a=at(i),o=c,n):(s=c,a=at(n),o=at(l),i),nt(d.u.cols,e,1,s),nt(d.b.cols,r,1,a),nt(d.d.cols,e,1,o),nt(d.f.cols,e,1,u),f.state.u=tt(d.u.cols),f.state.b=tt(d.b.cols),f.state.d=tt(d.d.cols),f.state.f=tt(d.f.cols)})}(X,V,O):"b"===I?function(f,d,t){t.depth;var h=t.double,b=(t.outer,t.prime);rt(t,function(t,e,r){var s,a,o,u,n=_(d.u.rows,r),l=_(d.l.cols,r),i=_(d.d.rows,e),c=_(d.r.cols,e);u=h?(s=at(i),a=at(c),o=at(n),at(l)):b?(s=at(l),a=i,o=at(c),n):(s=c,a=at(n),o=l,at(i)),nt(d.u.rows,t-1,1,s),nt(d.l.cols,t-1,1,a),nt(d.d.rows,e,1,o),nt(d.r.cols,e,1,u),f.state.u=et(d.u.rows),f.state.l=tt(d.l.cols),f.state.d=et(d.d.rows),f.state.r=tt(d.r.cols)})}(X,V,O):"d"===I&&function(c,f,t){t.depth;var d=t.double,h=(t.outer,t.prime);rt(t,function(t,e){var r,s,a,o,u=_(f.f.rows,e),n=_(f.r.rows,e),l=_(f.b.rows,e),i=_(f.l.rows,e);o=d?(r=l,s=i,a=u,n):h?(r=n,s=l,a=i,u):(r=i,s=u,a=n,l),nt(f.f.rows,e,1,r),nt(f.r.rows,e,1,s),nt(f.b.rows,e,1,a),nt(f.l.rows,e,1,o),c.state.f=et(f.f.rows),c.state.r=et(f.r.rows),c.state.b=et(f.b.rows),c.state.l=et(f.l.rows)})}(X,V,O),D})}}])&&a(t.prototype,e),r&&a(t,r),s}()});

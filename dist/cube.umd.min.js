!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t=t||self).cube=r()}(this,function(){"use strict";function e(t,r){for(var n=0;n<r.length;n++){var e=r[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function l(e){function t(t,r){var n=e.match(t);return Array.isArray(n)&&n[1]||r}var r=e.includes("w"),n=parseInt(t(/^([0-9]+)/,1),10);r&&(n=Math.max(2,n));var a=t(/([ULFRBDXYZ])/i,"").toUpperCase(),i=1;return e.endsWith("-")||e.endsWith("'")?i=-1:e.endsWith("2")&&(i=2),{depth:n,target:a,wide:r,rotation:i}}function a(t){var r=t.depth,n=t.target,e=t.wide,a=t.rotation,i="";1<r&&!e?i=2:2<r&&(i=r);var o=e?"w":"",c="";return-1===a?c="-":2===a&&(c=2),"".concat(i).concat(n).concat(o).concat(c)}function h(t){return r(D(t))}function D(e){var a=Math.sqrt(e.length);return new Array(a).fill().map(function(t,r){var n=r*a;return p(e,n,n+a)})}function U(t,r){return p(t,r).shift()}function B(t){return F(r(t))}function F(t){return t.reduce(function(t,r){return t.concat(r)},[])}function r(n){return n[0].map(function(t,r){return n.map(function(t){return t[r]})})}function i(t,n,r){var e=new Array(t).fill(n);return r?e.map(function(t,r){return{originalIndex:r,value:n}}):e}function L(t,r){for(var n=t.depth,e=n,a=t.wide?0:n-1;a<e;e--)r(e,-e,e-1)}function f(t,r){return Math.floor(Math.random()*(r-t+1))+t}function R(t){return p(t).reverse()}function d(t,r){return 1===r?B(R(D(t))):-1===r?F(R(h(t))):2===r?R(t):void 0}function p(t,r,n){return t.slice(r,n)}function m(t,r,n,e){return t.splice(r,n,e)}return function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,n),!function(t){return Number(t)===t&&t%1==0}(t)||t<2)throw new Error("Cube size must be a whole number greater than 1");this.size=t,this.options=r,this.reset()}return function(t,r,n){r&&e(t.prototype,r),n&&e(t,n)}(n,[{key:"generateScramble",value:function(t){var r=0<arguments.length&&void 0!==t?t:0;0===r&&(r=Math.pow(this.size,3));for(var n,e={U:["L","F","R","B"],L:["U","F","D","B"],F:["L","U","R","D"],R:["U","B","D","F"],B:["U","L","D","R"],D:["F","R","B","L"]},a=[],i=0;i<r;i++){var o=3<this.size?f(0,Math.floor(this.size/2)):1,c=[-1,1,2][f(0,2)],u=3<this.size&&!!f(0,1);n=i<1?["U","L","F","R","B","D"][f(0,5)]:e[n][f(0,3)],a.push({depth:o,wide:u,target:n,rotation:c})}return a}},{key:"generateScrambleString",value:function(t){var r=0<arguments.length&&void 0!==t?t:0;return this.generateScramble(r).map(a).join(" ")}},{key:"isSolved",value:function(){var t=this.state,r=t.U.length,n=t.U[0],e=t.L[0],a=t.F[0],i=t.R[0],o=t.B[0],c=t.D[0];if(this.options.useObjects){for(var u=1;u<r;u++)if(t.U[u].value!==n.value||t.L[u].value!==e.value||t.F[u].value!==a.value||t.R[u].value!==i.value||t.B[u].value!==o.value||t.D[u].value!==c.value)return!1}else for(var f=1;f<r;f++)if(t.U[f]!==n||t.L[f]!==e||t.F[f]!==a||t.R[f]!==i||t.B[f]!==o||t.D[f]!==c)return!1;return!0}},{key:"parseTurn",value:function(t){return l(t)}},{key:"reset",value:function(){var t=Math.pow(this.size,2),r=!!this.options.useObjects;this.state={U:i(t,0,r),L:i(t,1,r),F:i(t,2,r),R:i(t,3,r),B:i(t,4,r),D:i(t,5,r)}}},{key:"scramble",value:function(t){var r=0<arguments.length&&void 0!==t?t:0;this.currentScramble=this.generateScramble(r),this.turn(this.currentScramble,!1)}},{key:"stickers",value:function(t){var r=this.state,n=r.U,e=r.L,a=r.F,i=r.R,o=r.B,c=r.D;[].concat(n,e,a,i,o,c).forEach(t)}},{key:"turn",value:function(t){var s=this,v=this.state;(Array.isArray(t)?t:t.split(/[ ,]+/)).forEach(function(t){var r="string"==typeof t?l(t):t,n=r.depth,e=r.target,a=r.wide,i=r.rotation,o={date:Date.now(),parsedTurn:r};if("X"===e)!function(t,r){var n,e,a,i,o,c,u=t.state,f=-1===r.rotation;c=2===r.rotation?(n=p(u.D),e=d(u.L,2),a=R(u.B),i=d(u.R,2),o=R(u.F),p(u.U)):f?(n=R(u.B),e=d(u.L,1),a=p(u.U),i=d(u.R,-1),o=R(u.D),p(u.F)):(n=p(u.F),e=d(u.L,-1),a=p(u.D),i=d(u.R,1),o=R(u.U),R(u.B)),u.U=n,u.L=e,u.F=a,u.R=i,u.B=o,u.D=c}(s,r);else if("Y"===e)!function(t,r){var n,e,a,i,o,c,u=t.state,f=-1===r.rotation;c=2===r.rotation?(n=d(u.U,2),e=p(u.R),a=p(u.B),i=p(u.L),o=p(u.F),d(u.D,2)):f?(n=d(u.U,-1),e=p(u.B),a=p(u.L),i=p(u.F),o=p(u.R),d(u.D,1)):(n=d(u.U,1),e=p(u.F),a=p(u.R),i=p(u.B),o=p(u.L),d(u.D,-1)),u.U=n,u.L=e,u.F=a,u.R=i,u.B=o,u.D=c}(s,r);else if("Z"===e)!function(t,r){var n,e,a,i,o,c,u=t.state,f=-1===r.rotation;c=2===r.rotation?(n=R(u.D),e=R(u.R),a=d(u.F,2),i=R(u.L),o=d(u.B,2),R(u.U)):f?(n=d(u.R,-1),e=d(u.U,-1),a=d(u.F,-1),i=d(u.D,-1),o=d(u.B,1),d(u.L,-1)):(n=d(u.L,1),e=d(u.D,1),a=d(u.F,1),i=d(u.U,1),o=d(u.B,-1),d(u.R,1)),u.U=n,u.L=e,u.F=a,u.R=i,u.B=o,u.D=c}(s,r);else{if(1!==n&&!a||(v[e]=d(v[e],i)),n>=s.size){var c=2;1!==i&&-1!==i||(c=-1*i);var u=function(t){return{U:"D",L:"R",F:"B",R:"L",B:"F",D:"D"}[t]}(e);v[u]=d(v[u],c)}var f=function(t){var r=t.state,n=r.U,e=r.L,a=r.F,i=r.R,o=r.B,c=r.D;return{U:{r:D(n),c:h(n)},L:{r:D(e),c:h(e)},F:{r:D(a),c:h(a)},R:{r:D(i),c:h(i)},B:{r:D(o),c:h(o)},D:{r:D(c),c:h(c)}}}(s);"U"===e?function(t,v,l){var h=t.state;L(l,function(t,r,n){var e,a,i,o,c=U(v.B.r,n),u=U(v.R.r,n),f=U(v.F.r,n),s=U(v.L.r,n);o=2===l.rotation?(e=f,a=s,i=c,u):-1===l.rotation?(e=u,a=f,i=s,c):(e=s,a=c,i=u,f),m(v.B.r,n,1,e),m(v.R.r,n,1,a),m(v.F.r,n,1,i),m(v.L.r,n,1,o),h.B=F(v.B.r),h.R=F(v.R.r),h.F=F(v.F.r),h.L=F(v.L.r)})}(s,f,r):"L"===e?function(t,v,l){var h=t.state;L(l,function(t,r,n){var e,a,i,o,c=U(v.U.c,n),u=U(v.F.c,n),f=U(v.D.c,n),s=U(v.B.c,r);o=2===l.rotation?(e=f,a=R(s),i=c,R(u)):-1===l.rotation?(e=u,a=f,i=R(s),R(c)):(e=R(s),a=c,i=u,R(f)),m(v.U.c,n,1,e),m(v.F.c,n,1,a),m(v.D.c,n,1,i),m(v.B.c,r,1,o),h.U=B(v.U.c),h.F=B(v.F.c),h.D=B(v.D.c),h.B=B(v.B.c)})}(s,f,r):"F"===e?function(t,v,l){var h=t.state;L(l,function(t,r,n){var e,a,i,o,c=U(v.U.r,r),u=U(v.R.c,n),f=U(v.D.r,n),s=U(v.L.c,r);o=2===l.rotation?(e=R(f),a=R(s),i=R(c),R(u)):-1===l.rotation?(e=u,a=R(f),i=s,R(c)):(e=R(s),a=c,i=R(u),f),m(v.U.r,r,1,e),m(v.R.c,n,1,a),m(v.D.r,n,1,i),m(v.L.c,r,1,o),h.U=F(v.U.r),h.R=B(v.R.c),h.D=F(v.D.r),h.L=B(v.L.c)})}(s,f,r):"R"===e?function(t,v,l){var h=t.state;L(l,function(t,r,n){var e,a,i,o,c=U(v.U.c,r),u=U(v.B.c,n),f=U(v.D.c,r),s=U(v.F.c,r);o=2===l.rotation?(e=f,a=R(s),i=c,R(u)):-1===l.rotation?(e=R(u),a=R(f),i=s,c):(e=s,a=R(c),i=R(u),f),m(v.U.c,r,1,e),m(v.B.c,n,1,a),m(v.D.c,r,1,i),m(v.F.c,r,1,o),h.U=B(v.U.c),h.B=B(v.B.c),h.D=B(v.D.c),h.F=B(v.F.c)})}(s,f,r):"B"===e?function(t,v,l){var h=t.state;L(l,function(t,r,n){var e,a,i,o,c=U(v.U.r,n),u=U(v.L.c,n),f=U(v.D.r,r),s=U(v.R.c,r);o=2===l.rotation?(e=R(f),a=R(s),i=R(c),R(u)):-1===l.rotation?(e=R(u),a=f,i=R(s),c):(e=s,a=R(c),i=u,R(f)),m(v.U.r,t-1,1,e),m(v.L.c,t-1,1,a),m(v.D.r,r,1,i),m(v.R.c,r,1,o),h.U=F(v.U.r),h.L=B(v.L.c),h.D=F(v.D.r),h.R=B(v.R.c)})}(s,f,r):"D"===e&&function(t,s,v){var l=t.state;L(v,function(t,r){var n,e,a,i,o=U(s.F.r,r),c=U(s.R.r,r),u=U(s.B.r,r),f=U(s.L.r,r);i=2===v.rotation?(n=u,e=f,a=o,c):-1===v.rotation?(n=c,e=u,a=f,o):(n=f,e=o,a=c,u),m(s.F.r,r,1,n),m(s.R.r,r,1,e),m(s.B.r,r,1,a),m(s.L.r,r,1,i),l.F=F(s.F.r),l.R=F(s.R.r),l.B=F(s.B.r),l.L=F(s.L.r)})}(s,f,r)}return o})}}]),n}()});

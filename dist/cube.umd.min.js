!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.cube=r()}(this,function(){"use strict";function a(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ut(n){var t=function(t,r){var e=n.match(t);return Array.isArray(e)&&e[1]||r},r=n.includes("w"),e=parseInt(t(/^([0-9]+)/,1),10);r&&(e=Math.max(2,e));var a=t(/([ULFRBDXYZ])/i,"").toUpperCase(),i=1;return n.endsWith("-")||n.endsWith("'")?i=-1:n.endsWith("2")&&(i=2),{depth:e,target:a,wide:r,rotation:i}}function i(t){var r=t.depth,e=t.target,n=t.wide,a=t.rotation,i="";1<r&&!n?i=2:2<r&&(i=r);var o=n?"w":"",s="";return-1===a?s="-":2===a&&(s=2),"".concat(i).concat(e).concat(o).concat(s)}function ft(t){return r(ht(t))}function ht(n){var a=Math.sqrt(n.length);return new Array(a).fill().map(function(t,r){var e=r*a;return Lt(n,e,e+a)})}function vt(t,r){return Lt(t,r).shift()}function lt(t){return Dt(r(t))}function Dt(t){return t.reduce(function(t,r){return t.concat(r)},[])}function r(e){return e[0].map(function(t,r){return e.map(function(t){return t[r]})})}function o(t,e,r){var n=new Array(t).fill(e);return r?n.map(function(t,r){return{originalIndex:r,value:e}}):n}function Ut(t,r){for(var e=t.depth,n=e,a=t.wide?0:e-1;a<n;n--)r(n,-n,n-1)}function c(t,r){return Math.floor(Math.random()*(r-t+1))+t}function Bt(t){return Lt(t).reverse()}function Ft(t,r){return 1===r?lt(Bt(ht(t))):-1===r?Dt(Bt(ft(t))):2===r?Bt(t):void 0}function Lt(t,r,e){return t.slice(r,e)}function Rt(t,r,e,n){return t.splice(r,e,n)}return function(){function n(){var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,n),t=r,Number(t)!==t||t%1!=0||r<2)throw new Error("Cube size must be a whole number greater than 1");this.size=r,this.options=e,this.reset()}var t,r,e;return t=n,(r=[{key:"generateScramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;0===t&&(t=Math.pow(this.size,3));for(var r,e={U:["L","F","R","B"],L:["U","F","D","B"],F:["L","U","R","D"],R:["U","B","D","F"],B:["U","L","D","R"],D:["F","R","B","L"]},n=[],a=0;a<t;a++){var i=3<this.size?c(0,Math.floor(this.size/2)):1,o=[-1,1,2][c(0,2)],s=3<this.size&&!!c(0,1);r=a<1?["U","L","F","R","B","D"][c(0,5)]:e[r][c(0,3)],n.push({depth:i,wide:s,target:r,rotation:o})}return n}},{key:"generateScrambleString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.generateScramble(t).map(i).join(" ")}},{key:"isSolved",value:function(){var t=this.state.U.length,r=this.state.U[0],e=this.state.L[0],n=this.state.F[0],a=this.state.R[0],i=this.state.B[0],o=this.state.D[0];if(this.options.useObjects){for(var s=1;s<t;s++)if(this.state.U[s].value!==r.value||this.state.L[s].value!==e.value||this.state.F[s].value!==n.value||this.state.R[s].value!==a.value||this.state.B[s].value!==i.value||this.state.D[s].value!==o.value)return!1}else for(var c=1;c<t;c++)if(this.state.U[c]!==r||this.state.L[c]!==e||this.state.F[c]!==n||this.state.R[c]!==a||this.state.B[c]!==i||this.state.D[c]!==o)return!1;return!0}},{key:"parseTurn",value:function(t){return ut(t)}},{key:"reset",value:function(){var t=Math.pow(this.size,2),r=!!this.options.useObjects;this.state={U:o(t,0,r),L:o(t,1,r),F:o(t,2,r),R:o(t,3,r),B:o(t,4,r),D:o(t,5,r)}}},{key:"scramble",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.currentScramble=this.generateScramble(t),this.turn(this.currentScramble,!1)}},{key:"stickers",value:function(t){var r=this.state,e=r.U,n=r.L,a=r.F,i=r.R,o=r.B,s=r.D;[].concat(e,n,a,i,o,s).forEach(t)}},{key:"turn",value:function(t){var ct=this;(Array.isArray(t)?t:t.split(/[ ,]+/)).forEach(function(t){var f,h,v,l,D,U,B,F,L,R,d,p,m,y,g,b,w,k,r,e,n,a,i,o,s,c,u,z,S,M,A,j,x,E,C,O,T,W,I,X,Y,Z,q,N,P,G,H,J,K,Q,V,$,_="string"==typeof t?ut(t):t,tt=_.depth,rt=_.target,et=_.wide,nt=_.rotation,at={date:Date.now(),parsedTurn:_};if("X"===rt)N=_,V=ct.state,$=-1===N.rotation,Q=2===N.rotation?(P=Lt(V.D),G=Ft(V.L,2),H=Bt(V.B),J=Ft(V.R,2),K=Bt(V.F),Lt(V.U)):$?(P=Bt(V.B),G=Ft(V.L,1),H=Lt(V.U),J=Ft(V.R,-1),K=Bt(V.D),Lt(V.F)):(P=Lt(V.F),G=Ft(V.L,-1),H=Lt(V.D),J=Ft(V.R,1),K=Bt(V.U),Bt(V.B)),V.U=P,V.L=G,V.F=H,V.R=J,V.B=K,V.D=Q;else if("Y"===rt)C=_,Z=ct.state,q=-1===C.rotation,Y=2===C.rotation?(O=Ft(Z.U,2),T=Lt(Z.R),W=Lt(Z.B),I=Lt(Z.L),X=Lt(Z.F),Ft(Z.D,2)):q?(O=Ft(Z.U,-1),T=Lt(Z.B),W=Lt(Z.L),I=Lt(Z.F),X=Lt(Z.R),Ft(Z.D,1)):(O=Ft(Z.U,1),T=Lt(Z.F),W=Lt(Z.R),I=Lt(Z.B),X=Lt(Z.L),Ft(Z.D,-1)),Z.U=O,Z.L=T,Z.F=W,Z.R=I,Z.B=X,Z.D=Y;else if("Z"===rt)c=_,x=ct.state,E=-1===c.rotation,j=2===c.rotation?(u=Bt(x.D),z=Bt(x.R),S=Ft(x.F,2),M=Bt(x.L),A=Ft(x.B,2),Bt(x.U)):E?(u=Ft(x.R,-1),z=Ft(x.U,-1),S=Ft(x.F,-1),M=Ft(x.D,-1),A=Ft(x.B,1),Ft(x.L,-1)):(u=Ft(x.L,1),z=Ft(x.D,1),S=Ft(x.F,1),M=Ft(x.U,1),A=Ft(x.B,-1),Ft(x.R,1)),x.U=u,x.L=z,x.F=S,x.R=M,x.B=A,x.D=j;else{if((1===tt||et)&&(ct.state[rt]=Ft(ct.state[rt],nt)),tt>=ct.size){var it=2;1!==nt&&-1!==nt||(it=-1*nt);var ot={U:"D",L:"R",F:"B",R:"L",B:"F",D:"D"}[rt];ct.state[ot]=Ft(ct.state[ot],it)}var st=(r=ct.state,e=r.U,n=r.L,a=r.F,i=r.R,o=r.B,s=r.D,{U:{r:ht(e),c:ft(e)},L:{r:ht(n),c:ft(n)},F:{r:ht(a),c:ft(a)},R:{r:ht(i),c:ft(i)},B:{r:ht(o),c:ft(o)},D:{r:ht(s),c:ft(s)}});"U"===rt?(b=st,w=_,k=ct.state,Ut(w,function(t,r,e){var n,a,i,o,s=vt(b.B.r,e),c=vt(b.R.r,e),u=vt(b.F.r,e),f=vt(b.L.r,e);o=2===w.rotation?(n=u,a=f,i=s,c):-1===w.rotation?(n=c,a=u,i=f,s):(n=f,a=s,i=c,u),Rt(b.B.r,e,1,n),Rt(b.R.r,e,1,a),Rt(b.F.r,e,1,i),Rt(b.L.r,e,1,o),k.B=Dt(b.B.r),k.R=Dt(b.R.r),k.F=Dt(b.F.r),k.L=Dt(b.L.r)})):"L"===rt?(m=st,y=_,g=ct.state,Ut(y,function(t,r,e){var n,a,i,o,s=vt(m.U.c,e),c=vt(m.F.c,e),u=vt(m.D.c,e),f=vt(m.B.c,r);o=2===y.rotation?(n=u,a=Bt(f),i=s,Bt(c)):-1===y.rotation?(n=c,a=u,i=Bt(f),Bt(s)):(n=Bt(f),a=s,i=c,Bt(u)),Rt(m.U.c,e,1,n),Rt(m.F.c,e,1,a),Rt(m.D.c,e,1,i),Rt(m.B.c,r,1,o),g.U=lt(m.U.c),g.F=lt(m.F.c),g.D=lt(m.D.c),g.B=lt(m.B.c)})):"F"===rt?(R=st,d=_,p=ct.state,Ut(d,function(t,r,e){var n,a,i,o,s=vt(R.U.r,r),c=vt(R.R.c,e),u=vt(R.D.r,e),f=vt(R.L.c,r);o=2===d.rotation?(n=Bt(u),a=Bt(f),i=Bt(s),Bt(c)):-1===d.rotation?(n=c,a=Bt(u),i=f,Bt(s)):(n=Bt(f),a=s,i=Bt(c),u),Rt(R.U.r,r,1,n),Rt(R.R.c,e,1,a),Rt(R.D.r,e,1,i),Rt(R.L.c,r,1,o),p.U=Dt(R.U.r),p.R=lt(R.R.c),p.D=Dt(R.D.r),p.L=lt(R.L.c)})):"R"===rt?(B=st,F=_,L=ct.state,Ut(F,function(t,r,e){var n,a,i,o,s=vt(B.U.c,r),c=vt(B.B.c,e),u=vt(B.D.c,r),f=vt(B.F.c,r);o=2===F.rotation?(n=u,a=Bt(f),i=s,Bt(c)):-1===F.rotation?(n=Bt(c),a=Bt(u),i=f,s):(n=f,a=Bt(s),i=Bt(c),u),Rt(B.U.c,r,1,n),Rt(B.B.c,e,1,a),Rt(B.D.c,r,1,i),Rt(B.F.c,r,1,o),L.U=lt(B.U.c),L.B=lt(B.B.c),L.D=lt(B.D.c),L.F=lt(B.F.c)})):"B"===rt?(l=st,D=_,U=ct.state,Ut(D,function(t,r,e){var n,a,i,o,s=vt(l.U.r,e),c=vt(l.L.c,e),u=vt(l.D.r,r),f=vt(l.R.c,r);o=2===D.rotation?(n=Bt(u),a=Bt(f),i=Bt(s),Bt(c)):-1===D.rotation?(n=Bt(c),a=u,i=Bt(f),s):(n=f,a=Bt(s),i=c,Bt(u)),Rt(l.U.r,t-1,1,n),Rt(l.L.c,t-1,1,a),Rt(l.D.r,r,1,i),Rt(l.R.c,r,1,o),U.U=Dt(l.U.r),U.L=lt(l.L.c),U.D=Dt(l.D.r),U.R=lt(l.R.c)})):"D"===rt&&(f=st,h=_,v=ct.state,Ut(h,function(t,r){var e,n,a,i,o=vt(f.F.r,r),s=vt(f.R.r,r),c=vt(f.B.r,r),u=vt(f.L.r,r);i=2===h.rotation?(e=c,n=u,a=o,s):-1===h.rotation?(e=s,n=c,a=u,o):(e=u,n=o,a=s,c),Rt(f.F.r,r,1,e),Rt(f.R.r,r,1,n),Rt(f.B.r,r,1,a),Rt(f.L.r,r,1,i),v.F=Dt(f.F.r),v.R=Dt(f.R.r),v.B=Dt(f.B.r),v.L=Dt(f.L.r)}))}return at})}}])&&a(t.prototype,r),e&&a(t,e),n}()});
